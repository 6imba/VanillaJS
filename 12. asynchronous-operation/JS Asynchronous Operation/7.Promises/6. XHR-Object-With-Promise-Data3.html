<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h3>XMLHttpResponse Object, using promise to work with async code.</h3>
    <button id="getDataBtn">Load Data</button>

    <!-- 1 -->
    <!-- <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                // move all XHR code inside promise_contructor's-function
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time but dont wait, so async true.
                xhr.responseType = "json";
                xhr.onload = () => {
                    taskResolve(xhr.response);
                };
                xhr.send();
            })
            .then(promiseResponse => console.log(promiseResponse))
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api/user/1'));
    </script> -->


    <!-- 2 -->
    <!-- <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                // move all XHR code inside promise_contructor's-function
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time so async true.
                xhr.responseType = "json";
                xhr.onload = () => {
                    taskResolve(xhr.response);
                };
                xhr.send();
            })
            console.log(promise)
            console.log(promise.result)// You cannot access the Promise properties: state and result
            promise.then(promiseResponse => console.log(promiseResponse))
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api/users'));
    </script> -->

    <!-- 3 -->
    <!-- <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                //Producing code:(May take some time)
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time so async true.
                xhr.responseType = "json";
                xhr.onload = () => {
                    taskResolve(xhr.response); // when Producing code is successful else execute taskReject.
                };
                xhr.send();
            })
            // "Consuming Code" (Must wait for a fulfilled Promise)
            promise.then(promiseResponse => console.log(promiseResponse))
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api/users'));
    </script> -->

    <!-- 4.1 not the way -->
    <!-- <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                //Producing code:(May take some time)
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time so async true.
                xhr.responseType = "json";
                xhr.onload = () => { //onload is asynchronous function which will either success or reject
                    taskResolve(xhr.response); // when Producing code is successful execute taskResolve.
                    taskReject('Loading data failed!'); // when Producing code is not successful execute taskReject.
                };
                xhr.send();
            })
            //Consuming Code:(Must wait for a fulfilled Promise)
            promise.then(
                promiseResponse => console.log(promiseResponse),
                promiseResponse => console.log(promiseResponse)
                )
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api'));
    </script> -->

    <!-- 4.2 way -->
    <!-- <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                //Producing code:(May take some time)
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time so async true.
                xhr.responseType = "json";
                xhr.onload = () => { //onload is asynchronous function which will either success or reject
                    if(xhr.status == 200){
                        taskResolve(xhr.response); // when Producing code is successful execute taskResolve.
                    }else{
                        taskReject('Oe oe oe: Loading data failed!'); // when Producing code is not successful execute taskReject.
                    }
                };
                xhr.send();
            })
            //Consuming Code:(Must wait for a fulfilled Promise)
            promise.then(
                promiseResponse => console.log(promiseResponse),
                promiseResponse => console.log(promiseResponse)
                )
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api'));
    </script> -->



    <!-- 4.4 way -->
    <script>
        function loadData(method, url){
            const promise = new Promise((taskResolve, taskReject) => { // create new promise object using Promise() constructor which takes function with two args(resolve & reject)
                //Producing code:(May take some time)
                const xhr = new XMLHttpRequest();
                xhr.open(method, url, true); // while fetching data from file path it might take time so async true.
                xhr.responseType = "json";
                xhr.onload = () => { //onload is asynchronous function which will either success or reject
                    if(xhr.status == 200){
                        taskResolve(xhr.response); // when Producing code is successful execute taskResolve.
                    }else{
                        taskReject('Loading data failed!'); // when Producing code is not successful execute taskReject.
                    }
                };
                xhr.send();
            })
            //Consuming Code:(Must wait for a fulfilled Promise)
            .then(promiseResponse => console.log(promiseResponse))
            .catch(promiseError => console.log(promiseError))
        }
        const getBtn = document.getElementById("getDataBtn");
        getBtn.addEventListener("click", ()=>loadData('GET', 'https://reqres.in/api'));
    </script>

</body>
</html>